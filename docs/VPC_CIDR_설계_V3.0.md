# VPC CIDR 설계 (V3.0 확정)

> **작성일**: 2025-01-09  
> **프로젝트**: MSP-Project-Pilot-Light  
> **설계 원칙**: Public 작게, Private 크게, DynamoDB 사용으로 DB Subnet 불필요

---

## 서울 (ap-northeast-2) - Main Region

| 구분 | CIDR | 총 IP | 가용 IP | 용도 |
|------|------|-------|---------|------|
| **VPC** | `10.0.0.0/24` | 256 | - | 전체 |
| **Public-2a** | `10.0.0.0/27` | 32 | 27 | ALB, NAT GW |
| **Public-2c** | `10.0.0.32/27` | 32 | 27 | ALB, NAT GW |
| **Private(App)-2a** | `10.0.0.64/26` | 64 | 59 | WEB/APP EC2, ASG |
| **Private(App)-2c** | `10.0.0.128/26` | 64 | 59 | WEB/APP EC2, ASG |
| *(여유)* | `10.0.0.192/26` | 64 | 59 | 확장용 |

---

## 도쿄 (ap-northeast-1) - DR Region

| 구분 | CIDR | 총 IP | 가용 IP | 용도 |
|------|------|-------|---------|------|
| **VPC** | `10.0.1.0/24` | 256 | - | 전체 |
| **Public-1a** | `10.0.1.0/27` | 32 | 27 | ALB, NAT GW |
| **Public-1c** | `10.0.1.32/27` | 32 | 27 | ALB, NAT GW |
| **Private(App)-1a** | `10.0.1.64/26` | 64 | 59 | WEB/APP EC2, ASG |
| **Private(App)-1c** | `10.0.1.128/26` | 64 | 59 | WEB/APP EC2, ASG |
| *(여유)* | `10.0.1.192/26` | 64 | 59 | 확장용 |

---

## 시각화

```
서울 VPC: 10.0.0.0/24 (256 IP)
├── Public:     10.0.0.0/27, 10.0.0.32/27     (총 54 가용)
├── Private:    10.0.0.64/26, 10.0.0.128/26   (총 118 가용)
└── 여유:       10.0.0.192/26                  (59 가용)

도쿄 VPC: 10.0.1.0/24 (256 IP)
├── Public:     10.0.1.0/27, 10.0.1.32/27     (총 54 가용)
├── Private:    10.0.1.64/26, 10.0.1.128/26   (총 118 가용)
└── 여유:       10.0.1.192/26                  (59 가용)
```

---

## 리전 구분 규칙

| 3번째 옥텟 | 리전 |
|------------|------|
| `10.0.0.x` | 서울 (Main) |
| `10.0.1.x` | 도쿄 (DR) |

---

## 검증 결과

- ✅ CIDR 비중복
- ✅ VPC Peering 가능
- ✅ DynamoDB 사용으로 DB Subnet 불필요
- ✅ 여유 공간 확보 (확장용)

---

## 참고: 여유 공간 활용 예시

| 용도 | 설명 |
|------|------|
| 추가 Private Subnet | Lambda VPC 연결용 |
| Bastion/Management | 관리용 서버 전용 Subnet |
| VPC Endpoint 전용 | Interface Endpoint 배치 |
| 미사용 | 그냥 비워둬도 됨 |

---

## ⚠️ 제한사항 (발표 시 언급 권장)

이 설계는 **데모/PoC 목적**에 적합합니다.

| 항목 | 현재 설계 (/26) | 프로덕션 권장 (/20) |
|------|-----------------|---------------------|
| AZ당 가용 IP | 59개 | 4,091개 |
| 최대 EC2 수 | ~59대/AZ | ~4,000대/AZ |
| 양쪽 AZ 합계 | ~118대 | ~8,000대 |

실제 K-POP 티켓팅 10만 동시접속 시에는 `/20 이상`으로 확장 필요합니다.
